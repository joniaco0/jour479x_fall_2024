The goal of this presentation is to find the best players on the worst teams, who has succeeded the most but cannot reap the benefits. For this, I want all players in the past 20 years that is a qualified hitter, which Fangraphs filters out themselves. This is what I have from that. 
```{r}
install.packages("baseballr")
if (!requireNamespace('pacman', quietly = TRUE)){
  install.packages('pacman')
}
pacman::p_load_current_gh("BillPetti/baseballr")

```
```{r}
library(baseballr)
library(dplyr)
library(tidyverse)
library(readr)

```
```{r}
batting_data <- read_csv("C:/desktop/jour479x_fall_2024/JoniacoBaseball - Sheet2.csv")
```
```{r}
View(batting_data)
```
This is all qualified batters from 2004 to 2024, there are a couple problems with this set. Some players have played on two teams. I want only players that stuck out the whole season. So I'm filtering for only players that have these teams. 
```{r}
Teams <- c("ARI", "LAD", "NYY", "BAL", "MIL", "PHI", "SDP", "HOU", "NYM", "MIN", "TOR", "CHC", "CLE", "SEA", "BOS", "KCR", "DET", "ATL", "SFG", "TEX", "STL", "TBR", "OAK", "WSN", "CIN", "PIT", "MIA", "LAA", "COL", "CHW")
batting_data |> filter(Team %in% Teams)
```
```{r}



```
```{r}
library(baseballr)
library(dplyr)

# Create an empty dataframe to store the standings for all years and divisions
all_standings <- data.frame()

# Loop over each year from 2004 to 2024
for (year in 2004:2023) {
  # Convert the year to a string and create the date (assuming October 1st as the end of the season)
  date_str <- paste0(year, "-10-01")
  
  # Get AL standings for the year
  al_standings <- bref_standings_on_date(date = date_str, division = "AL Overall")
  
  # Get NL standings for the year
  nl_standings <- bref_standings_on_date(date = date_str, division = "NL Overall")
  
  # Add a column to identify the league (AL or NL)
  al_standings$League <- "AL"
  nl_standings$League <- "NL"
  
  # Add a column specifying the season for each team (e.g., 2004, 2005, etc.)
  al_standings$Season <- year
  nl_standings$Season <- year
  
  # Combine AL and NL standings for the year
  year_standings <- bind_rows(al_standings, nl_standings)
  
  # Append to the overall standings dataframe
  all_standings <- bind_rows(all_standings, year_standings)
}

# View the combined standings for all years and leagues, including the season column
head(all_standings)

```
I am currently trying this function to pull standings data. It needs some tweaking, but the idea is to join both tables. (This was generated by ChatGPT but is getting modfied.)

Here is how the data in the players table will be arranged.
```{r}
batting_data |> select(Season,Name,Team,G,WAR)
```
The idea is to create a metric, divding it by the Wins Above Replacement(WAR) of each player with the wins of the team they were from, there are other ways to find production, like looking at wRC+ for offensive production or Defensive Runs Saved or defensive grade for defense, but for now, WAR/Wins is the start. 
